!function t(e,r,s){function c(i,n){if(!r[i]){if(!e[i]){var o="function"==typeof require&&require;if(!n&&o)return o(i,!0);if(a)return a(i,!0);var l=new Error("Cannot find module '"+i+"'");throw l.code="MODULE_NOT_FOUND",l}var u=r[i]={exports:{}};e[i][0].call(u.exports,function(t){var r=e[i][1][t];return c(r?r:t)},u,u.exports,t,e,r,s)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<s.length;i++)c(s[i]);return c}({1:[function(t,e,r){"use strict";var s={container:Util.getCurrentTab(),listContainer:$("#project-list-container"),proxy:{getProjectWar:"/publish/monitor/wars.do",checkAllProjectStatus:"/publish/monitor/checkAllWars.do",checkStatus:"/publish/monitor/checkStatus"},_cacheConfigErrorList:[],init:function(){var t=this;t.renderProjectList(),t.bindEvents()},bindEvents:function(){var t=this,e=t.getSearchFormElem();t.listContainer.on("click",".-check-status-btn",function(){var e=$(this);return!e.hasClass("disabled")&&void t.doCheckStatus(e.data("id"),e.closest("li"))}),t.container.on("click",".-ser-btn",function(){t.filterItems(e[0].dir.value||"")}).on("click",".-check-all-status",function(){t.doCheckAllStatus()}),e.on("keydown",function(t){if(13===t.keyCode)return t.preventDefault(),e.find(".-ser-btn").trigger("click"),!1})},filterItems:function(t){var e=this,r=[];if(t){if("configerror"===t.toLowerCase())return e.fillProjectWars(e._cacheConfigErrorList);$.each(e._cacheData,function(e,s){s.name.search(new RegExp(t,"i"))!==-1&&r.push(s)}),r.length?e.fillProjectWars(r,$.isPlainObject(r[0].host)):e.fillProjectWars([])}else e.fillProjectWars(e._cacheData,$.isPlainObject(e._cacheData[0].host))},doCheckAllStatus:function(){var t=this,e=t.addLoading(t.listContainer);Util.baseAjax({url:t.proxy.checkAllProjectStatus,complete:function(){e.remove()}},function(e){var r;return e=e||{},r=e.data,e.success&&r?(t._cacheData=r,void t.fillProjectWars(r,!0)):Util.baseSuccessTips(e,"",e.msg||"检查失败")})},addLoading:function(t){return t.loading({modal:{opacity:40},loader:{cls:"loader-circle",width:30,height:30}})},doCheckStatus:function(t,e){var r=this,s=r.addLoading(e);Util.baseAjax({url:r.proxy.checkStatus,data:{id:t},complete:function(){s.remove()}},function(t){var s;if(t=t||{},s=t.data,!t.success||!s)return Util.baseSuccessTips(t,"",t.msg||"操作失败");var c=!0,a=[];$.each(s,function(t,e){a.push({host:t,status:e.status}),!e.status&&(c=!1)}),e.addClass(c?"check-success":"check-error").removeClass(c?"check-error":"check-success"),e.find(".host-container").html(r.fillHostItems(a))})},renderProjectList:function(){var t=this;Util.baseAjax({url:t.proxy.getProjectWar},function(e){var r;return e=e||{},r=e.data,e.success&&r?(t._cacheData=r,void t.fillProjectWars(r)):Util.baseSuccessTips(e,"",e.msg||"获取项目失败")})},fillHostItems:function(t){var e="<div class=\"{% return data.status ? 'cor-success' : data.status === false? 'cor-error' : '' %}\"><span class=\"d-ib va-m w-25 ta-r\">host-{index}:</span><span class=\"d-ib va-m ml-10px\">{host}</span></div>",r="",s=0;return $.each(t||[],function(t,c){r+=Util.renderTpl(e,{index:s++,host:c.host,status:c.status})}),r},fillProjectWars:function(t,e){var r=this,s=[],c="";$.each(t||[],function(t,a){var i=!0,n=!0,o=[];$.isArray(a.host)?o=$.map(a.host,function(t){return{host:t}}):$.each(a.host,function(t,e){o.push({host:t,status:e.status}),!e.status&&(i=!1)}),!$.isEmptyObject(a.host)&&a.checkUri||(i=!1,a.disabled="disabled",a.configError='<span class="cor-error d-ib ml-20px va-m  mt-5px">配置不正确</span>',n=!1,s.push(a)),a.hosts=r.fillHostItems(o),a.checkResultClass=e?i?"check-success":"check-error":n?"":"check-error",c+=Util.renderTpl(r.getProjectItemTpl(),a)}),r._cacheConfigErrorList=s,r.listContainer.html(c)},getProjectItemTpl:function(){var t=$("#project-status-item-tpl").html();return this.getProjectItemTpl=function(){return t},t},getSearchFormElem:function(){var t=this.container.find(".-search-form");return this.getSearchFormElem=function(){return t},t}};s.init()},{}]},{},[1]);