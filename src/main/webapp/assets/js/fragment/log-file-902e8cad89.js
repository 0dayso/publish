!function e(t,i,n){function r(a,l){if(!i[a]){if(!t[a]){var s="function"==typeof require&&require;if(!l&&s)return s(a,!0);if(o)return o(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var u=i[a]={exports:{}};t[a][0].call(u.exports,function(e){var i=t[a][1][e];return r(i?i:e)},u,u.exports,e,t,i,n)}return i[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,i){"use strict";var n={container:Util.getCurrentTab(),proxy:{getDir:"/publish/shell/listDir.do",getFileContent:"/publish/shell/getlog.do",getMachines:"/publish/remoteshell/allHost.do"},init:function(){var e=this,t=e.getSearchFormElem()[0],i=$("#page-main").height()-110-e.getSearchFormElem().height();e.container.find(".-container-height").height(i),e.getLogContainerElem().height(i-36),e.getMachineData(function(e){Util.Form.loadSelectOptions(t.hostinfo,e,"请选择操作机器")}),e.bindEvents()},destroy:function(){this.grid.destroy(),this.container.off(".LogFile")},bindEvents:function(){var e=this,t=e.getSearchFormElem();e.container.on("click.LogFile",".-ser-btn",function(){return!!t.validate("validation")&&(e.renderPath(t[0].dir.value||""),void e.renderDir({hostinfo:t[0].hostinfo.value,dir:t[0].dir.value}))}).on("click.LogFile",".-file",function(){var i=t[0].dir.value,n=$(this).attr("title"),r=i+("/"===i.slice(-1)?n:"/"+n);return!!t.validate("validation")&&(e.renderLogFile({filename:r,lines:t[0].lines.value,hostinfo:t[0].hostinfo.value}),void e.renderPath(r||""))}).on("click.LogFile",".-folder",function(){var i=t[0].dir.value,n=$(this).attr("title");return t[0].dir.value=i+("/"===i.slice(-1)?n:"/"+n),!!t.validate("validation")&&(e.renderDir({hostinfo:t[0].hostinfo.value,dir:t[0].dir.value}),void e.renderPath(t[0].dir.value||""))}).on("click.LogFile",".path>i:not(:first)",function(){var i=[$(this).text()],n="";e.getLogContainerElem().html(""),$(this).nextAll("i").each(function(){i.unshift($(this).text())}),n=i.join("/"),e.renderDir({hostinfo:t[0].hostinfo.value,dir:n}),e.renderPath(n||""),t[0].dir.value=n}),t.on("keydown",function(e){if(13===e.keyCode)return e.preventDefault(),t.find(".-ser-btn").trigger("click"),!1})},renderLogFile:function(e){var t=this;Util.baseAjax({url:t.proxy.getFileContent,data:e},function(e){e=e||{},Util.baseSuccessTips(e,"获取目录成功","获取目录失败"),e.success&&e.data&&t.getLogContainerElem().html('<pre class="pre-line">'+e.data+"</pre>")})},getDirData:function(e,t){var i=this;Util.baseAjax({url:i.proxy.getDir,data:e},function(e){e=e||{},e.success&&e.data?$.isFunction(t)&&t(e.data):Util.baseSuccessTips(e,"获取目录成功","获取目录失败")})},renderPath:function(e){var t=this,i=e.split("/").reverse(),n="";$.each(i,function(e,t){n+='<i class="iconfont '+(0===e?"":"icon-slash")+'"><b class="cur-p">'+t+"</b></i>"}),t.getPathContainerElem().html(n)},renderDir:function(e){var t=this,i='<li class="relative {fileOrFolder}" title="{text}"><i class="success-cor iconfont icon-file {folder}"></i><span class="ml-5px ov-e w-150px d-ib">{text}</span></li>';t.getDirData(e,function(e){var n="";$.each(e,function(){n+=Util.renderTpl(i,{fileOrFolder:"dir"==this.type?"-folder":"-file",folder:"dir"==this.type?"icon-folder text-base-cor":"",text:this.name})}),t.getFolderTreeElem().html(n)})},getFolderTreeElem:function(){var e=this.container.find(".tree");return this.getFolderTreeElem=function(){return e},e},getPathContainerElem:function(){var e=this.container.find(".path");return this.getPathContainerElem=function(){return e},e},getLogContainerElem:function(){var e=this.container.find(".-log-file-container");return this.getLogContainerElem=function(){return e},e},getSearchFormElem:function(){var e=this.container.find(".-search-form");return this.getSearchFormElem=function(){return e},e},getMachineData:function(e){var t=this;Util.baseAjax({url:t.proxy.getMachines},function(t){var i,n,r=[];if(t=t||{},t.success&&t.data){n=t.data;for(i in n)r.push({key:n[i],value:i});$.isFunction(e)&&e(r)}})}};n.init()},{}]},{},[1]);