void function(t){"use strict";function e(e){this.options=t.extend(!0,{},{proxy:{read:"",create:"",update:"",del:""}},e),t.Grid.call(this,this.options),t.extend(!0,this,{hiddenTools:!1,overwriteToolbar:!1,beforeCreateDialog:!1},this.options),o.initGrid.call(this)}function n(e){t.extend(!0,this,{container:!1,content:"",header:"",timeout:!1,offerCommonAjax:!1,beforeSubmitFilterData:!1,loadData:!1,style:{width:"430px",height:"auto",type:"notification",layout:"center",theme:"defaultTheme",modal:!0},buttons:[],events:{onSaveSuccess:t.noop,onBeforeShow:t.noop,onShow:t.noop,onClose:t.noop,afterClose:t.noop},notyIns:null},e),i.init.call(this)}var o={initGrid:function(){},defaultOpts:{toolbar:[{name:"add",text:"添加",icon:"iconfont icon-add",handle:function(t){t.data.createDialog("add")}},{name:"edit",text:"修改",icon:"iconfont icon-edit",handle:function(t){t.data.createDialog("edit")}},{name:"delete",text:"删除",icon:"iconfont icon-delete",handle:function(t){t.data.createDialog("delete")}}],dialogOpts:[{name:"add",header:{title:"添加"},content:"",buttons:[{text:"保存继续",icon:"iconfont icon-confirm",cls:"btn btn-success",handle:function(e,n){var o=e.$bar.find("form"),i=n.data;return!!o.validate("validation",{parentPositionR:!1})&&void i.submit("string"===t.type(i.gridIns.proxy.create)?{url:i.gridIns.proxy.create,type:"post"}:i.gridIns.proxy.create,Util.parseParam(o.serialize()),function(t){t.success&&(o[0].reset(),i.gridIns.reload())})}},{text:"保存",icon:"iconfont icon-confirm",cls:"btn btn-success",handle:function(e,n){var o=e.$bar.find("form"),i=n.data;return!!o.validate("validation",{parentPositionR:!1})&&void i.submit("string"===t.type(i.gridIns.proxy.create)?{url:i.gridIns.proxy.create,type:"post"}:i.gridIns.proxy.create,Util.parseParam(o.serialize()),function(t){t.success&&(i.close(),i.gridIns.reload())})}},{text:"取消",icon:"iconfont icon-cancel",cls:"btn btn-danger",handle:function(t){t.close()}}]},{name:"edit",header:{title:"修改"},buttons:[{text:"保存",icon:"iconfont icon-confirm",cls:"btn btn-success",handle:function(e,n){var o=e.$bar.find("form"),i=n.data;return!!o.validate("validation",{parentPositionR:!1})&&void i.submit("string"===t.type(i.gridIns.proxy.update)?{url:i.gridIns.proxy.update,type:"post"}:i.gridIns.proxy.update,Util.parseParam(o.serialize()),function(t){t.success&&(i.close(),i.gridIns.reload())})}},{text:"取消",icon:"iconfont icon-cancel",cls:"btn btn-danger",handle:function(t){t.close()}}]},{name:"delete",header:{title:"删除"},content:'<div class="dialog-content text-base-red p-20px fz-14px"> <i class="iconfont icon-info mr-5px"></i><span>您确定删除该条记录吗？</span></div>',style:{width:310},beforeSubmitFilterData:function(t){var e=this.gridIns.getSelectedData();return{id:e.id}},buttons:[{text:"确定",icon:"iconfont icon-confirm",cls:"btn btn-success",handle:function(e,n){var o=e.$bar.find("form"),i=n.data;return!!o.validate("validation",{parentPositionR:!1})&&void i.submit("string"===t.type(i.gridIns.proxy.del)?{url:i.gridIns.proxy.del,type:"post"}:i.gridIns.proxy.del,Util.parseParam(o.serialize()),function(t){t.success&&(i.close(),i.gridIns.reload())})}},{text:"取消",icon:"iconfont icon-cancel",cls:"btn btn-danger",handle:function(t){t.close()}}]}]},packOpts:function(e){var n=t.extend(!0,{},o.defaultOpts),i=!1;return t.isPlainObject(e.overwriteToolbar)&&(e.overwriteToolbar=[e.overwriteToolbar]),t.isArray(e.overwriteToolbar)&&t.each(e.overwriteToolbar,function(e,o){t.each(n.toolbar,function(e){o.name===this.name&&t.extend(!0,n.toolbar[e],o)})}),e.toolbar=e.toolbar?n.toolbar.concat(e.toolbar):n.toolbar,t.isArray(e.hiddenTools)&&(e.toolbar=t.grep(e.toolbar,function(n){return t.inArray(n.name,e.hiddenTools)===-1})),t.isPlainObject(e.dialogOpts)&&(e.dialogOpts=[e.dialogOpts]),t.isArray(e.dialogOpts)&&t.each(e.dialogOpts,function(e,o){i=!1,n.dialogOpts=t.map(n.dialogOpts,function(e){return o.name===e.name?(i=!0,t.extend(!0,e,o)):e}),!i&&n.dialogOpts.push(o)}),e.dialogOpts=n.dialogOpts,e},createDialog:function(t){return new n(t)},showDialog:function(e){var n=this,i={};t.each(n.dialogOpts,function(){if(this.name===e)return t.extend(!0,i,this),!1}),i.gridIns=n,i.offerCommonAjax=n.offerCommonAjax,o.createDialog(i)},handles:{}};Util.inherit(t.Grid,e),t.extend(e.prototype,{createDialog:function(e){return(!t.isFunction(this.beforeCreateDialog)||this.beforeCreateDialog(e)!==!1)&&void o.showDialog.call(this,e)}});var i={init:function(){var t=this,e=i.packOpts.call(this);t.notyIns=t.container?t.container.noty(e):noty(e)},packOpts:function(){var e=this;return{custom:e.custom||!1,style:{width:+e.style.width?e.style.width+"px":e.style.width,height:+e.style.height?e.style.height+"px":e.style.height},type:e.style.type,modal:e.style.modal,layout:e.style.layout,theme:e.style.theme,header:e.header,text:e.text,template:"string"==typeof e.content?/^(\.|#)[-_A-Za-z][-_A-Za-z0-9]+/.test(e.content)?t(e.content).html():e.content:e.content instanceof jQuery?e.content.html():e.content.innerHTML,timeout:e.timeout,callback:{onShow:function(){this.$bar.addClass("dialog-base-theme"),e.events.onBeforeShow.call(e,this),this.$bar.find("form").validate({parentPositionR:!1}),t.isFunction(e.loadData)&&e.loadData.call(e,this.$bar.find("form"))},afterShow:e.events.onShow,onClose:e.events.onClose,afterClose:e.events.afterClose},buttons:t.map(e.buttons,function(t){return{addClass:t.cls,onClick:t.handle,text:t.text,eventData:e}})}}};t.extend(n.prototype,{close:function(){this.notyIns.close()},submit:function(e,n,o){var i=this;"string"===t.type(e)&&(e={url:e}),t.isFunction(i.beforeSubmitFilterData)&&(n=i.beforeSubmitFilterData.call(i,n)),t.isFunction(i.offerCommonAjax)&&i.offerCommonAjax(t.extend(!0,{data:n,dataType:"json",loading:!0,success:function(e){e=e||{},t.isFunction(o)&&o.call(i,e),e.success&&t.isFunction(i.events.onSaveSuccess)&&i.events.onSaveSuccess.call(i,e),noty({text:e.msg,type:e.success?"success":"error",timeout:5e3,layout:"topCenter",theme:"defaultTheme"})}},e))}}),t.Dialog=n,t.fn.grid=function(t){return t.container=this,new e(o.packOpts(t))}}(jQuery);